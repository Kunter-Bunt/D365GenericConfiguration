"use strict"; var GenericConfigurationReader = function () { function e() { } return e.GetString = function (n, t, o) { return new Promise(function (i) { e.Get(n, o).then(function (e) { null !== e && null !== e.mwo_value ? i(e.mwo_value) : i(t) }) }) }, e.GetBool = function (n, t, o) { return new Promise(function (i) { e.Get(n, o).then(function (e) { var n = t; if (null !== e && null !== e.mwo_value) { var o = e.mwo_value.toLowerCase(); "true" === o ? n = !0 : "false" === o && (n = !1) } i(n) }) }) }, e.GetNumber = function (n, t, o) { return new Promise(function (i) { e.Get(n, o).then(function (e) { var n = t; if (null !== e && null !== e.mwo_value) { var o = Number(e.mwo_value); Number.isNaN(o) || (n = o) } i(n) }) }) }, e.GetList = function (n, t, o) { return new Promise(function (i) { e.Get(n, o).then(function (e) { var n = t; if (null !== e && null !== e.mwo_value) { var o = 122870006 === e.mwo_type ? ";" : ","; n = e.mwo_value.split(o) } i(n) }) }) }, e.GetObject = function (n, t, o) { return new Promise(function (i) { e.Get(n, o).then(function (e) { if (null !== e && null !== e.mwo_value) try { 122870001 === e.mwo_type || e.mwo_value.startsWith("{") || e.mwo_value.startsWith("[") ? i(JSON.parse(e.mwo_value)) : 122870002 === e.mwo_type || e.mwo_value.StartsWith("<") ? i((new window.DOMParser).parseFromString(e.mwo_value, "text/xml").documentElement) : i(t) } catch (e) { console.warn("Failed to generate Object: " + e), i(t) } else i(t) }) }) }, e.Get = function (e, n) { var t = this; return new Promise(function (o) { var i = t.GetFromCache(e, n); i ? o(i) : Xrm.WebApi.retrieveMultipleRecords("mwo_genericconfiguration", "?$select=mwo_value,mwo_type&$filter=mwo_key eq '" + e + "'").then(function (i) { i.entities && i.entities.length > 0 ? (t.SaveToCache(e, i.entities[0], n), o(i.entities[0])) : o(null) }) }) }, e.GetFromCache = function (e, n) { return n && n.getItem("mwo_genericconfiguration_" + e) ? JSON.parse(n.getItem("mwo_genericconfiguration_" + e)) : null }, e.SaveToCache = function (e, n, t) { t && t.setItem("mwo_genericconfiguration_" + e, JSON.stringify(n)) }, e }();